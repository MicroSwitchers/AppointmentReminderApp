<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Visual Appointment Timer">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#61dafb">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-TileColor" content="#61dafb">
    <meta name="msapplication-tap-highlight" content="no">

    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="./vta-192.png">
    <link rel="apple-touch-icon" sizes="192x192" href="./vta-192.png">
    <link rel="apple-touch-icon" sizes="512x512" href="./vta-512.png">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="./vta-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="./vta-512.png">
    <link rel="shortcut icon" href="./vta-192.png">

    <title>Visual Appointment Timer</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Modern Timer Hub -->
        <div id="timerHubContainer" class="timer-hub-container">
            <!-- Floating Action Button -->
            <button id="timerHubFab" class="timer-hub-fab" onclick="toggleTimerHub()" aria-label="Toggle active timers" title="View active timers">
                ⏲️
                <span id="timerHubBadge" class="timer-hub-badge">0</span>
            </button>

            <!-- Expandable Panel -->
            <div id="timerHubPanel" class="timer-hub-panel">
                <div class="timer-hub-panel-header">
                    <h3 class="timer-hub-panel-title">Active Timers</h3>
                    <button class="timer-hub-close" onclick="toggleTimerHub()" aria-label="Close timer panel">×</button>
                </div>
                <div id="timerHubList" class="timer-hub-list">
                    <!-- Dynamic content will be inserted here -->
                </div>
            </div>
        </div>

        <div class="main-container">
            <div class="app-header">
                <img src="vta-512.png" alt="App Icon" class="app-icon" loading="lazy">
                <h1 class="app-title">Visual Appointment Reminders</h1>
            </div>

            <div id="currentTime"></div>

            <div class="form-section">
                <div class="form-row">
                    <label for="tagSelect">Appointment Type:</label>
                    <select id="tagSelect">
                        <option value="General">General</option>
                        <option value="Home Appointment">Home Appointment</option>
                        <option value="Online Appointment">Online Appointment</option>
                        <option value="Meeting">Meeting</option>
                        <option value="Travel">Travel</option>
                        <option value="Report">Report</option>
                        <option value="Service Plan">Service Plan</option>
                        <option value="Stats">Stats</option>
                        <option value="Office">Office</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-row">
                    <label for="descInput">Appointment Initials (2 letters):</label>
                    <input type="text" id="descInput" maxlength="2" placeholder="e.g., DR, MT, WK" pattern="[A-Za-z]{2}" title="Please enter exactly 2 letters">
                    <small class="field-help">Short code to identify this appointment type</small>
                    <div class="input-feedback" id="descFeedback"></div>
                </div>

                <div class="form-row">
                    <label for="appointmentTime">Alarm Time:</label>
                    <input type="time" id="appointmentTime" required
                           step="60"
                           pattern="[0-9]{2}:[0-9]{2}"
                           title="Select appointment time"
                           autocomplete="off">
                    <small class="field-help">Time when the appointment starts</small>
                    <div class="input-feedback" id="timeFeedback"></div>
                </div>

                <div class="reminder-section">
                    <label>Reminder Times: <span class="selected-count" id="selectedCount">(1 selected)</span></label>
                    <div class="reminder-grid">
                        <div class="reminder-item">
                            <input type="checkbox" name="reminder" id="reminder3h" value="180" data-label="3h">
                            <label for="reminder3h">
                                3h
                                <span class="checkmark">✓</span>
                            </label>
                        </div>
                        <div class="reminder-item">
                            <input type="checkbox" name="reminder" id="reminder2h" value="120" data-label="2h">
                            <label for="reminder2h">
                                2h
                                <span class="checkmark">✓</span>
                            </label>
                        </div>
                        <div class="reminder-item">
                            <input type="checkbox" name="reminder" id="reminder1h30" value="90" data-label="1.5h">
                            <label for="reminder1h30">
                                1.5h
                                <span class="checkmark">✓</span>
                            </label>
                        </div>
                        <div class="reminder-item">
                            <input type="checkbox" name="reminder" id="reminder1h" value="60" data-label="1h" checked>
                            <label for="reminder1h">
                                1h
                                <span class="checkmark">✓</span>
                            </label>
                        </div>
                        <div class="reminder-item">
                            <input type="checkbox" name="reminder" id="reminder45m" value="45" data-label="45m">
                            <label for="reminder45m">
                                45m
                                <span class="checkmark">✓</span>
                            </label>
                        </div>
                        <div class="reminder-item">
                            <input type="checkbox" name="reminder" id="reminder20m" value="20" data-label="20m">
                            <label for="reminder20m">
                                20m
                                <span class="checkmark">✓</span>
                            </label>
                        </div>
                        <div class="reminder-item">
                            <input type="checkbox" name="reminder" id="reminder15m" value="15" data-label="15m">
                            <label for="reminder15m">
                                15m
                                <span class="checkmark">✓</span>
                            </label>
                        </div>
                        <div class="reminder-item">
                            <input type="checkbox" name="reminder" id="reminder10m" value="10" data-label="10m">
                            <label for="reminder10m">
                                10m
                                <span class="checkmark">✓</span>
                            </label>
                        </div>
                        <div class="reminder-item">
                            <input type="checkbox" name="reminder" id="reminder5m" value="5" data-label="5m">
                            <label for="reminder5m">
                                5m
                                <span class="checkmark">✓</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="warning-section">
                    <label>
                        <input type="checkbox" id="threeMinuteWarning" class="three-minute-checkbox">
                        <span class="checkbox-label">🔔 3-minute audible warning before appointment</span>
                    </label>
                    <small class="field-help">Play an alarm sound 3 minutes before the appointment starts</small>
                </div>

                <div class="volume-section">
                    <label>Volume Control:</label>
                    <div class="volume-controls">
                        <label for="volumeSlider">Volume:</label>
                        <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="80">
                        <span id="volumeValue">80%</span>
                    </div>
                </div>

                <div class="button-container">
                    <button class="add-button" onclick="addAppointment()">Add Appointment</button>
                </div>
            </div>

            <div class="appointments-section" id="appointmentList"></div>
        </div>

        <!-- Please Read Drawer -->
        <div class="please-read-container">
            <button class="please-read-toggle" onclick="togglePleaseRead()">
                📖 Please Read
                <span class="toggle-arrow" id="pleaseReadArrow">▼</span>
            </button>
            <div class="please-read-content" id="pleaseReadContent">
                <p>
                    <strong>Important:</strong> The Visual Appointment Reminders app saves data locally and may not function if your device goes to sleep. It was designed to be used as a Progressive Web App. This means it is installed through a browser like Chrome or Edge so that it has an icon to launch it. Once open, it is meant to stay open and visible on a device (i.e., leaving it open on a second computer screen as a visual reminder).
                </p>
                <p>
                    <strong>Audio Alerts:</strong> The reminder time will always create an audible alarm and notification. Optionally, you can enable a 3-minute warning alarm that will sound before the appointment starts. The appointment time itself is silent so it doesn't disturb meetings that may be beginning at that time.
                </p>
                <p>
                    <strong>Privacy:</strong> This app only stores data locally in your browser. No information you enter is transmitted online or shared with any external services. All your appointment data remains completely private on your device.
                </p>
            </div>
        </div>
    </div>

    <audio id="warningBeep" preload="auto" crossorigin="anonymous">
        <source src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" type="audio/mpeg">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAeAy6R1++7cyMFKIHH8N6QQAoWXrLq665UFApGn97z" type="audio/wav">
    </audio>

    <audio id="alarmSound" preload="auto" crossorigin="anonymous">
        <source src="https://assets.mixkit.co/active_storage/sfx/209/209-preview.mp3" type="audio/mpeg">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAeAy6R1++7cyMFKIHH8N6QQAoWXrLq665UFApGn97z" type="audio/wav">
    </audio>

    <script src="./performance-patch.js"></script>
    <script src="./app.js" defer></script>
</body>
</html>
